geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
labs("Model")
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
plot(ridge_model_y_predictions, main = "Ridge")
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
plot(lasso_model_y_predictions, main = "Lasso")
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
plot(stat_model_y_predictions, main = "MLR")
stat_model_y_predictions
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(name = "Dose", labels = c("A", "B", "C"))
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
plot(ridge_model_y_predictions, main = "Ridge")
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
plot(lasso_model_y_predictions, main = "Lasso")
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
plot(stat_model_y_predictions, main = "MLR")
stat_model_y_predictions
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(name = "Dose", labels = c("A", "B", "C"))
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
plot(ridge_model_y_predictions, main = "Ridge")
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
plot(lasso_model_y_predictions, main = "Lasso")
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
plot(stat_model_y_predictions, main = "MLR")
stat_model_y_predictions
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions)+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
labs("Dose")+
scale_fill_discrete(name = "Dose", labels = c("A", "B", "C"))
# knit options
knitr::opts_chunk$set(echo = F,
results = 'markup',
fig.width = 4,
fig.height = 3,
fig.align = 'center',
message = F,
warning = F)
# packages
library(tidyverse)
library(faraway)
library(RSQLite)
library(skimr)
library(GGally)
library(tidymodels)
library(leaps)
library(glmnet)
library(gridExtra)
ball <- dbConnect(drv=RSQLite::SQLite(), dbname="../../data/database.sqlite")
batting <- dbGetQuery(ball, "
SELECT
sum(ab) AS AT_BAT,
player_id,
sum(r) AS RUNS,
sum(hr) AS HOME_RUNS,
sum(triple) AS TRIPLE,
sum(double) AS DOUBLE,
(sum(h) -  sum(hr) - sum(triple) - sum(double)) AS SINGLES,
sum(bb) AS WALKS,
sum(ibb) AS INT_WALKS,
sum(sb) AS STOLEN_BASES,
sum(hbp) AS HIT_BY_PITCH
FROM
batting
where
year > 2000
group by
player_id
")
sumbat <- batting
batting <- subset(batting,batting[,1]>100)
for (x in 3:11)
{
batting[,x] <- batting[,x] / 1
}
set.seed(5)
batting <- sample_n(batting, 500, replace = FALSE)
players <- dbGetQuery(ball, "
SELECT
player_id,
(weight / POWER(height, 2)) *703 AS BMI,
bats as HAND
FROM
player
")
players <- subset(players, players[,2]>0)
for ( x in 1:17918)
{
if(players[x,2] <= 18.5) {players[x,2] <- "U"}
else if(players[x,2] <= 24.9) {players[x,2] <- "H"}
else if(players[x,2] <= 29.9) {players[x,2] <- "O"}
else {players[x,2] <- "B"}
}
batting <-  merge(batting, players, by="player_id" )
#Final Model
stat_model <- lm(RUNS~HOME_RUNS + SINGLES + WALKS + STOLEN_BASES, data = batting)
summary(stat_model)
y <- batting$RUNS
x <- data.matrix(batting[, c('AT_BAT', 'HOME_RUNS', 'SINGLES', 'WALKS', 'STOLEN_BASES', 'WALKS', 'INT_WALKS', 'STOLEN_BASES', 'HIT_BY_PITCH')])
ridge_model <- glmnet(x, y, alpha = 0)
summary(ridge_model)
cv_model_ridge <- cv.glmnet(x, y, alpha = 0)
# find optimal lambda value that minimizes test MSE
best_lambda_r <- cv_model_ridge$lambda.min
best_lambda_r
# produce plot of test MSE by lambda value
plot(cv_model_ridge)
#find coefficients of best model
best_model <- glmnet(x, y, alpha=0, lamba = best_lamba_r)
#coef(best_model_ridge)
# produce ridge trace plot
plot(ridge_model, xvar = 'lambda')
#calculate R-squared
y_predicted <- predict(ridge_model, s = best_lambda_r, newx =x)
#SST and SSE
sst <- sum((y-mean(y))^2)
sse <- sum((y_predicted - y)^2)
rsq <- 1-(sse/sst)
rsq
y <- batting$RUNS
x <- data.matrix(batting[, c('AT_BAT', 'HOME_RUNS', 'SINGLES', 'WALKS', 'STOLEN_BASES', 'WALKS', 'INT_WALKS', 'STOLEN_BASES', 'HIT_BY_PITCH')])
model <- glmnet(x, y, alpha = 1)
summary(model)
cv_model <- cv.glmnet(x, y, alpha = 1)
# find optimal lambda value that minimizes test MSE
best_lambda <- cv_model$lambda.min
best_lambda
# produce plot of test MSE by lambda value
plot(cv_model)
#find coefficients of best model
best_model <- glmnet(x, y, alpha=1, lamba = best_lamba)
#coef(best_model)
# produce ridge trace plot
plot(model, xvar = 'lambda')
#calculate R-squared
y_predicted <- predict(model, s = best_lambda, newx =x)
#SST and SSE
sst <- sum((y-mean(y))^2)
sse <- sum((y_predicted - y)^2)
rsq <- 1-(sse/sst)
rsq
cv_model$lambda.min
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
plot(ridge_model_y_predictions, main = "Ridge")
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
plot(lasso_model_y_predictions, main = "Lasso")
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
plot(stat_model_y_predictions, main = "MLR")
stat_model_y_predictions
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 1) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =1)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =1 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 1) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =1)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =1 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.text = "hi")
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.text = c("hi","h","i")
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.text = c("hi","h","i"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.title = "Model")
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.title = element_text("Model"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm, title("hi"))+
theme(legend.title = element_text("Model"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
theme(legend.title = element_text("Model"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
labs(fill = "Dose (mg)")
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
labs(fill = "Dose (mg)")
ggplot() +
labs(fill = "Dose (mg)") +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
theme(legend.title="hi")+
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
theme(legend.title= element_text(color = "blue", size = 10))+
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", fill = "hi"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", labs = "hi"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", name = "hi"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", main = "hi"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", fill = "Ridge"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red",fill = "Stat"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", fill = "Ridge"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"fill = "Lasso"), lasso_model_y_predictions, size =0.5 )+
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red",fill = "Stat"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue", fill = "Ridge"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black", fill = "Lasso"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
legend(fill="hi")
?legend
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
legend()
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(name = “Dose”, labels = c(“A”, “B”, “C”))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(name = "Dose", labels = c("A", "B", "C"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(name = "colour", labels = c("A", "B", "C"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
scale_fill_discrete(colour, name = "colour", labels = c("A", "B", "C"))
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)+
legend(colour)
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
par(mfrow = c(1,3))
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ridge_model_y_predictions <- data.frame(Prediction = 1:500, Actual= 1:500)
ridge_model_y_predictions[,1] <- predict(ridge_model, s = best_lambda_r, newx = x)
ridge_model_y_predictions[,2] <- batting$RUNS
lasso_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
lasso_model_y_predictions[,1] <- predict(cv_model, s = best_lambda_r, newx = x)
lasso_model_y_predictions[,2] <- batting$RUNS
stat_model_y_predictions <- data.frame(Prediction = 1:500, Actual = 1:500)
stat_model_y_predictions[,1] <- predict(stat_model, newx = x)
stat_model_y_predictions[,2] <- batting$RUNS
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
ggplot() +
geom_point(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions,size = 0.5) +
geom_smooth(aes(x=Prediction, y=Actual, color="red"), stat_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, size =0.5)+
geom_smooth(aes(x=Prediction, y=Actual, color="blue"), ridge_model_y_predictions, method = lm)+
geom_point(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, size =0.5 )+
geom_smooth(aes(x=Prediction, y=Actual, color="black"), lasso_model_y_predictions, method = lm)
